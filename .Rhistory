as.numeric(modelPlaces2["parkLat"][1,])
modelPlaces2["parkLat"]
modelPlaces2 <- modelPlaces %>% mutate(parkLat = latParks)%>% mutate(parkLng = lngParks) %>% st_drop_geometry()
as.numeric(modelPlaces2["parkLat"][1,])
as.numeric(modelPlaces2["parkLng"][1,])
route4 <-  osrmRoute(src = c(as.numeric(CensusData2["bgLat"][1,]), as.numeric(CensusData2["bgLng"][1,])),
dst = c(as.numeric(modelPlaces2["parkLat"][1,]), as.numeric(modelPlaces2["parkLng"][1,])),
osrm.profile = "car",
overview = FALSE)
route4
route4 <-  osrmRoute(src = c(as.numeric(CensusData2["bgLat"][1,]), as.numeric(CensusData2["bgLng"][1,])),
dst = c(as.numeric(modelPlaces2["parkLat"][100,]), as.numeric(modelPlaces2["parkLng"][100,])),
osrm.profile = "car",
overview = FALSE)
route4
route4 <-  osrmRoute(src = c(as.numeric(CensusData2["bgLat"][1,]), as.numeric(CensusData2["bgLng"][1,])),
dst = c(as.numeric(modelPlaces2["parkLat"][100,]), as.numeric(modelPlaces2["parkLng"][100,])),
osrm.profile = "car",
overview = TRUE)
as.numeric(modelPlaces2["parkLat"][100,]
)
as.numeric(modelPlaces2["parkLng"][100,])
# parks
attemptmodelPlaces<- as.character(modelPlaces$geometry)
attemptmodelPlaces <- attemptmodelPlaces %>% str_replace("\\(","") %>%
str_replace("\\)","")%>%
str_replace("c","")
latParks = map(attemptmodelPlaces,function(x){
medium = str_split(x,",")
medium = medium[[1]][2]
return(medium)
})
lngParks = map(attemptmodelPlaces,function(x){
medium = str_split(x,",")
medium = medium[[1]][1]
return(medium)
})
latParks = unlist(latParks)
lngParks = unlist(lngParks)
modelPlaces2 <- modelPlaces %>% mutate(parkLat = latParks)%>% mutate(parkLng = lngParks) %>% st_drop_geometry()
# census
attemptCensusData<- as.character(CensusData$originGeometry)
attemptCensusData <- attemptCensusData %>% str_replace("\\(","") %>%
str_replace("\\)","")%>%
str_replace("c","")
latCensus = map(attemptCensusData,function(x){
medium = str_split(x,",")
medium = medium[[1]][2]
return(medium)
})
lngCensus = map(attemptCensusData,function(x){
medium = str_split(x,",")
medium = medium[[1]][1]
return(medium)
})
latCensus = unlist(latCensus)
lngCensus = unlist(lngCensus)
CensusData2 <- CensusData %>% mutate(bgLat = latCensus)%>% mutate(bgLng = lngCensus)
#openstreetmap
u <- "https://routing.openstreetmap.de/"
options(osrm.server = u)
options(digits=8)
route4 <-  osrmRoute(src = c(as.numeric(CensusData2["bgLat"][1,]), as.numeric(CensusData2["bgLng"][1,])),
dst = c(as.numeric(modelPlaces2["parkLat"][100,]), as.numeric(modelPlaces2["parkLng"][100,])),
osrm.profile = "car",
overview = TRUE)
#openstreetmap
u <- "https://routing.openstreetmap.de/routed-car/"
options(osrm.server = u)
options(digits=8)
route4 <-  osrmRoute(src = c(as.numeric(CensusData2["bgLat"][1,]), as.numeric(CensusData2["bgLng"][1,])),
dst = c(as.numeric(modelPlaces2["parkLat"][100,]), as.numeric(modelPlaces2["parkLng"][100,])),
osrm.profile = "car",
overview = TRUE)
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = TRUE)
route4
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = TRUE)
#openstreetmap
u <- "https://routing.openstreetmap.de"
options(osrm.server = u)
options(digits=8)
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = TRUE)
#openstreetmap
u <- "https://routing.openstreetmap.de/"
options(osrm.server = u)
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = TRUE)
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = FALSE)
route4
route4 <-  osrmRoute(src = c(as.numeric(CensusData2["bgLat"][1,]), as.numeric(CensusData2["bgLng"][1,])),
dst = c(as.numeric(modelPlaces2["parkLat"][100,]), as.numeric(modelPlaces2["parkLng"][100,])),
osrm.profile = "car",
overview = FALSE)
route4
as.numeric(CensusData2["bgLat"][1,])
# as.numeric(CensusData2["bgLat"][1,])  39.981442
as.numeric(CensusData2["bgLng"][1,])
as.numeric(modelPlaces2["parkLat"][100,])
#as.numeric(modelPlaces2["parkLat"][100,])
as.numeric(modelPlaces2["parkLng"][100,])
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981442, -75.178765),
dst = c(39.955165, -75.167341),
osrm.profile = "car",
overview = FALSE)
route4
resultsDistance = gmapsdistance("39.981442+-75.178765", "39.955165+-75.167341", mode="driving", shape="long")
resultsDistance
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981442, -75.178765),
dst = c(39.955165, -75.167341),
overview = FALSE)
route4
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981442, -75.178765),
dst = c(39.955165, -75.167341),
overview = TRUE)
#https://rdrr.io/cran/osrm/man/osrmRoute.html
library(osrm)
#openstreetmap
options(osrm.server = "http://0.0.0.0:5000/", osrm.profile = "car")
options(digits=8)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981442, -75.178765),
dst = c(39.955165, -75.167341),
overview = TRUE)
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = FALSE)
getOption("osrm.server")
st_write(modelPlaces2,"modelPlaces2.csv")
st_write(CensusData2,"CensusData2.csv")
#openstreetmap
options(osrm.server = "https://routing.openstreetmap.de/", osrm.profile = "car")
options(digits=8)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981442, -75.178765),
dst = c(39.955165, -75.167341),
overview = TRUE)
#openstreetmap
options(osrm.server = "https://routing.openstreetmap.de/routed-foot/")
options(digits=8)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981442, -75.178765),
dst = c(39.955165, -75.167341),
overview = TRUE)
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = FALSE)
route4
#openstreetmap
options(osrm.server = "http://0.0.0.0:5000/",osrm.profile = "car")
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = FALSE)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981442, -75.178765),
dst = c(39.955165, -75.167341),
overview = FALSE)
library(tidyverse)
library(gmapsdistance)
#https://rdrr.io/cran/osrm/man/osrmRoute.html
library(osrm)
library(sf)
# st_write(CensusData2,"CensusData2.csv")
CensusData2 <- st_read("CensusData2.csv")
# st_write(modelPlaces2,"modelPlaces2.csv")
modelPlaces2 <- st_read("modelPlaces2.csv")
#openstreetmap
options(osrm.server = "http://0.0.0.0:5000/", osrm.profile = "car")
options(digits=8)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
overview = FALSE)
#openstreetmap
options(osrm.server = "http://127.0.0.1:5000/", osrm.profile = "car")
options(digits=8)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
overview = FALSE)
route4
route4
#openstreetmap
options(osrm.server = "http://127.0.0.1:5000/", osrm.profile = "car")
options(digits=8)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
overview = FALSE)
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = FALSE)
route4
route4
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
returnclass = "sf")
route4
#openstreetmap
options(osrm.server = "http://127.0.0.1:9966/", osrm.profile = "car")
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
overview = FALSE)
#openstreetmap
options(osrm.server = "http://172.17.0.5:9966/", osrm.profile = "car")
options(digits=8)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
overview = FALSE)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
returnclass = "sf")
#openstreetmap
options(osrm.server = "http://172.17.0.1:5000/", osrm.profile = "car")
#openstreetmap
options(osrm.server = "http://172.17.0.1:5000/", osrm.profile = "driving")
options(digits=8)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
returnclass = "sf")
#openstreetmap
options(osrm.server = "http://172.17.0.1:5000/")
#openstreetmap
options(osrm.server = "http://0.0.0.0:5000/")
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
returnclass = "sf")
sudo apt install -y libcurl4-openssl-dev libgeos-dev
#openstreetmap
options(osrm.server = "http://127.0.0.1:5000/")
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
returnclass = "sf")
route4
View(route4)
#openstreetmap
options(osrm.server = "http://127.0.0.1:5000/")
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
returnclass = "sf")
route4
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
overview = FALSE)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167))
route4
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
overview = FALSE)
#openstreetmap
getwd()
#openstreetmap
setwd("D:/")
options(osrm.server = "http://127.0.0.1:5000/")
options(digits=8)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
overview = FALSE)
library(osmrRoute)
library(osrmRoute)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.981, -75.178),
dst = c(39.955, -75.167),
overview = "full", returnclass = "sf")
View(route4)
apotheke.df <- read.csv(system.file("csv/apotheke.csv", package = "osrm"))
apotheke.sf <- st_read(system.file("gpkg/apotheke.gpkg", package = "osrm"),
quiet = TRUE)
apotheke.sf[1, ]
st_crs(modelPlaces)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.961, -75.178),
dst = c(39.955, -75.167),
overview = "full", returnclass = "sf")
route4
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.961, -75.178),
dst = c(39.925, -75.167),
overview = "full", returnclass = "sf")
route4
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(39.961, -75.178),
dst = c(39.925, -75.147),
overview = "full", returnclass = "sf")
route4
route4 <-  osrmRoute(src = c(13.412, 52.502),
dst = c(13.454, 52.592),
overview = FALSE)
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(-75.178,39.961),
dst = c(-75.147,39.925),
overview = "full", returnclass = "sf")
route4
s.numeric(modelPlaces2["parkLat"][100,])
as.numeric(modelPlaces2["parkLat"][100,])
as.numeric(modelPlaces2["parkLng"][100,])
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(-75.178765,39.981442),
dst = c(-75.167341,39.955165),
overview = "full", returnclass = "sf")
route4
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(as.numeric(CensusData2["bgLng"][1,]),as.numeric(CensusData2["bgLat"][1,])),
dst = c(as.numeric(modelPlaces2["parkLng"][100,]),as.numeric(modelPlaces2["parkLat"][100,])),
overview = "full", returnclass = "sf")
route4
# as.numeric(CensusData2["bgLat"][1,])  39.981442
# as.numeric(CensusData2["bgLng"][1,])  -75.178765
#as.numeric(modelPlaces2["parkLat"][100,])
# as.numeric(modelPlaces2["parkLng"][100,])
route4 <-  osrmRoute(src = c(as.numeric(CensusData2["bgLng"][1,]),as.numeric(CensusData2["bgLat"][1,])),
dst = c(as.numeric(modelPlaces2["parkLng"][100,]),as.numeric(modelPlaces2["parkLat"][100,])),
overview = "FALSE")
route4
route4[2]
len(CensusData2)
nrow(CensusData2)
range(nrow(CensusData2))
range(1:nrow(CensusData2))
a <- range(1:nrow(CensusData2))
a <- range[1:nrow(CensusData2)]
attempt = map(modelPlaces2,function(x){
print(x)
})
attempt = map(modelPlaces2,function(x){
print(x[1])
})
print(x[2])
attempt = map(modelPlaces2,function(x){
print(x[2])
})
View(modelPlaces2)
attempt = map(modelPlaces2,function(x){
print(x[1])
})
theList = list()
theList.append(1)
append(theList,1)
theList
theList = append(theList,1)
View(theList)
theList = c()
theList = append(theList,1)
theList
i=1
dst = c(as.numeric(modelPlaces2["parkLng"][i,]),as.numeric(modelPlaces2["parkLat"][i,]))
theVector = c()
for (j in 1:nrow(modelPlaces2)){
src = c(as.numeric(CensusData2["bgLng"][j,]),as.numeric(CensusData2["bgLat"][j,]))
medium = osrmRoute(src,dst,overview = "FALSE")
theVector = append(theVector,medium[2])
}
theVector
theDistanceMatrix= append(theDistanceMatrix,theVector)
theDistanceMatrix=list()
theDistanceMatrix= append(theDistanceMatrix,theVector)
View(theDistanceMatrix)
theDistanceMatrix=list()
theDistanceMatrix= append(theDistanceMatrix,list(theVector))
View(theDistanceMatrix)
theDistanceMatrix=list()
for(i in 1:nrow(CensusData2)){
dst = c(as.numeric(modelPlaces2["parkLng"][i,]),as.numeric(modelPlaces2["parkLat"][i,]))
theVector = c()
for (j in 1:nrow(modelPlaces2)){
src = c(as.numeric(CensusData2["bgLng"][j,]),as.numeric(CensusData2["bgLat"][j,]))
medium = osrmRoute(src,dst,overview = "FALSE")
theVector = append(theVector,medium[2])
}
theDistanceMatrix= append(theDistanceMatrix,list(theVector))
}
library(tidyverse)
library(gmapsdistance)
#https://rdrr.io/cran/osrm/man/osrmRoute.html
library(osrm)
library(sf)
# st_write(modelPlaces2,"modelPlaces2.csv")
modelPlaces2 <- st_read("modelPlaces2.csv")
# st_write(CensusData2,"CensusData2.csv")
CensusData2 <- st_read("CensusData2.csv")
#openstreetmap
# setwd("D:/")
options(osrm.server = "http://127.0.0.1:5000/")
options(digits=8)
theDistanceMatrix=list()
#openstreetmap
# setwd("D:/")
options(osrm.server = "http://127.0.0.1:5000/")
options(digits=8)
theDistanceMatrix=list()
for(i in 1:nrow(CensusData2)){
src = c(as.numeric(CensusData2["bgLng"][i,]),as.numeric(CensusData2["bgLat"][i,]))
theVector = c()
for (j in 1:nrow(modelPlaces2)){
dst = c(as.numeric(modelPlaces2["parkLng"][j,]),as.numeric(modelPlaces2["parkLat"][j,]))
medium = osrmRoute(src,dst,overview = "FALSE")
theVector = append(theVector,medium[2])
}
theDistanceMatrix= append(theDistanceMatrix,list(theVector))
print(paste0("finish ...",i,"/",nrow(CensusData2)))
# Sys.sleep(3)
}
theDistanceMatrix2 <- theDistanceMatrix
daFrame <- matrix(unlist(theDistanceMatrix2), nrow=length(theDistanceMatrix2), byrow=TRUE)
View(daFrame)
st_write(daFrame,"data/output/theDistanceMatrixWhole.csv")
daFrame <- as.data.frame(matrix(unlist(theDistanceMatrix2), nrow=length(theDistanceMatrix2), byrow=TRUE))
View(daFrame)
st_write(daFrame,"data/output/theDistanceMatrixWhole.csv")
