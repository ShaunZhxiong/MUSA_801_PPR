dplyr::select(OBJECTID,MILES)
attracGEO <- attractivenssData %>% dplyr::select(placekey)
View(attracGEO)
pprTrails <- st_read('https://opendata.arcgis.com/datasets/48323d574068405bbf5336b9b5b29455_0.geojson')%>%
st_transform(crs=32118) %>%
filter(TRAIL_STATUS =="EXISTING") %>%
dplyr::select(OBJECTID,MILES) %>%
st_buffer(10) %>%
st_join(attracGEO %>% st_transform(crs=32118))
pprTrails <- st_read('https://opendata.arcgis.com/datasets/48323d574068405bbf5336b9b5b29455_0.geojson')%>%
st_transform(crs=32118) %>%
filter(TRAIL_STATUS =="EXISTING") %>%
dplyr::select(OBJECTID,MILES) %>%
st_buffer(10) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_transform(crs = crs) %>%
drop_na()
pprTrails <- st_read('https://opendata.arcgis.com/datasets/48323d574068405bbf5336b9b5b29455_0.geojson')%>%
st_transform(crs=32118) %>%
filter(TRAIL_STATUS =="EXISTING") %>%
dplyr::select(MILES) %>%
st_buffer(10) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry() %>%
drop_na()
attractivenssData <- attractivenssData %>%left_join(pprTrails, by="placekey")
attractivenssData$MILES[is.na(attractivenssData$MILES)] <- 0
View(pprBuildingStructures)
View(pprOutPrograms)
View(pprPicnicSites)
pprPicnicSites <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_picnic_sites&filename=ppr_picnic_sites&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
dplyr::select(table_count) %>%
st_buffer(10) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()
pprPicnicSites <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_picnic_sites&filename=ppr_picnic_sites&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
dplyr::select(table_count) %>%
st_buffer(10) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()
# the length of the trail
pprTrails <- st_read('https://opendata.arcgis.com/datasets/48323d574068405bbf5336b9b5b29455_0.geojson')%>%
st_transform(crs=32118) %>%
filter(TRAIL_STATUS =="EXISTING") %>%
dplyr::select(MILES) %>%
st_buffer(10) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry() %>%
drop_na() %>%
rename("trailMiles" = "MILES")
# attractivenssData <- modelData.attr %>% left_join(modelPlaces,by="placekey")
# st_write(attractivenssData,"data/output/attractivenssData.GEOJSON")
attractivenssData <- st_read("data/output/attractivenssData.GEOJSON")
attracGEO <- attractivenssData %>% dplyr::select(placekey)
attractivenssData <- attractivenssData %>% dplyr::select(-naics_code) %>% rename("area" = "attractiveness")
# the area of the facilities
# the number of inside facilities - buildingStructures
attractivenssData <- attractivenssData %>% mutate(insideFacility = NA)
# the length of the trail
pprTrails <- st_read('https://opendata.arcgis.com/datasets/48323d574068405bbf5336b9b5b29455_0.geojson')%>%
st_transform(crs=32118) %>%
filter(TRAIL_STATUS =="EXISTING") %>%
dplyr::select(MILES) %>%
st_buffer(10) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry() %>%
drop_na() %>%
rename("trailMiles" = "MILES")
attractivenssData <- attractivenssData %>%left_join(pprTrails, by="placekey")
attractivenssData$MILES[is.na(attractivenssData$MILES)] <- 0
# attractivenssData <- modelData.attr %>% left_join(modelPlaces,by="placekey")
# st_write(attractivenssData,"data/output/attractivenssData.GEOJSON")
attractivenssData <- st_read("data/output/attractivenssData.GEOJSON")
attracGEO <- attractivenssData %>% dplyr::select(placekey)
attractivenssData <- attractivenssData %>% dplyr::select(-naics_code) %>% rename("area" = "attractiveness")
# the area of the facilities
# the number of inside facilities - buildingStructures
attractivenssData <- attractivenssData %>% mutate(insideFacility = NA)
# the length of the trail
pprTrails <- st_read('https://opendata.arcgis.com/datasets/48323d574068405bbf5336b9b5b29455_0.geojson')%>%
st_transform(crs=32118) %>%
filter(TRAIL_STATUS =="EXISTING") %>%
dplyr::select(MILES) %>%
st_buffer(10) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry() %>%
drop_na() %>%
rename("trailMiles" = "MILES")
attractivenssData <- attractivenssData %>%left_join(pprTrails, by="placekey")
attractivenssData$trailMiles[is.na(attractivenssData$trailMiles)] <- 0
pprPicnicSites <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_picnic_sites&filename=ppr_picnic_sites&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
dplyr::select(table_count) %>%
st_buffer(10) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
rename("picnicTable" = "table_count")
pprPicnicSites <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_picnic_sites&filename=ppr_picnic_sites&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
dplyr::select(table_count) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
rename("picnicTable" = "table_count")
pprPicnicSites <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_picnic_sites&filename=ppr_picnic_sites&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
dplyr::select(table_count) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
rename("picnicTable" = "table_count") %>%
group_by(placekey) %>%
summarise(picnicTable = sum(picnicTable))
attractivenssData <- attractivenssData %>%left_join(pprPicnicSites, by="placekey")
attractivenssData$picnicTable[is.na(attractivenssData$picnicTable)] <- 0
# the length of the trail
pprTrails <- st_read('https://opendata.arcgis.com/datasets/48323d574068405bbf5336b9b5b29455_0.geojson')%>%
st_transform(crs=32118) %>%
filter(TRAIL_STATUS =="EXISTING") %>%
dplyr::select(MILES) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry() %>%
drop_na() %>%
rename("trailMiles" = "MILES")
View(pprTrails)
# the length of the trail
pprTrails <- st_read('https://opendata.arcgis.com/datasets/48323d574068405bbf5336b9b5b29455_0.geojson')%>%
st_transform(crs=32118) %>%
filter(TRAIL_STATUS =="EXISTING") %>%
dplyr::select(MILES) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry() %>%
drop_na() %>%
rename("trailMiles" = "MILES")%>%
group_by(placekey) %>%
summarise(trailMiles = sum(trailMiles))
# attractivenssData <- modelData.attr %>% left_join(modelPlaces,by="placekey")
# st_write(attractivenssData,"data/output/attractivenssData.GEOJSON")
attractivenssData <- st_read("data/output/attractivenssData.GEOJSON")
attracGEO <- attractivenssData %>% dplyr::select(placekey)
attractivenssData <- attractivenssData %>% dplyr::select(-naics_code) %>% rename("area" = "attractiveness")
# the area of the facilities
# the number of inside facilities - buildingStructures
attractivenssData <- attractivenssData %>% mutate(insideFacility = NA)
# the length of the trail
pprTrails <- st_read('https://opendata.arcgis.com/datasets/48323d574068405bbf5336b9b5b29455_0.geojson')%>%
st_transform(crs=32118) %>%
filter(TRAIL_STATUS =="EXISTING") %>%
dplyr::select(MILES) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry() %>%
drop_na() %>%
rename("trailMiles" = "MILES")%>%
group_by(placekey) %>%
summarise(trailMiles = sum(trailMiles))
attractivenssData <- attractivenssData %>%left_join(pprTrails, by="placekey")
attractivenssData$trailMiles[is.na(attractivenssData$trailMiles)] <- 0
# the number of the picnic tables
pprPicnicSites <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_picnic_sites&filename=ppr_picnic_sites&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
dplyr::select(table_count) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
rename("picnicTable" = "table_count") %>%
group_by(placekey) %>%
summarise(picnicTable = sum(picnicTable))
attractivenssData <- attractivenssData %>%left_join(pprPicnicSites, by="placekey")
attractivenssData$picnicTable[is.na(attractivenssData$picnicTable)] <- 0
View(pprAdExercise)
pprAdExercise <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_adult_exercise_equipment&filename=ppr_adult_exercise_equipment&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()
pprAdExercise <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_adult_exercise_equipment&filename=ppr_adult_exercise_equipment&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(exerciseNum = sum(count))
pprAdExercise <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_adult_exercise_equipment&filename=ppr_adult_exercise_equipment&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(exerciseNum = sum(count))
attractivenssData <- attractivenssData %>%left_join(pprAdExercise, by="placekey")
attractivenssData$exerciseNum[is.na(attractivenssData$exerciseNum)] <- 0
View(pprSwimmingPool)
pprSwimmingPool <- st_read('https://opendata.arcgis.com/datasets/c6f6176968f04d3f88adbc4c362af55d_0.geojson')%>%
st_transform(crs=32118) %>%
filter(POOL_STATUS =="ACTIVE") %>%
ggplot() +
geom_sf(data=pprSwimmingPool,color=palette1_main,fill = palette1_main)+
geom_sf(data=st_union(pprDistrict),color="black",size=2,fill = "transparent")+
geom_sf(data=pprDistrict,color="black",size=1,linetype ="dashed",fill = "transparent")+
labs(title = "",
subtitle = "",
x="",y="")+
mapTheme()
pprSwimmingPool <- st_read('https://opendata.arcgis.com/datasets/c6f6176968f04d3f88adbc4c362af55d_0.geojson')%>%
st_transform(crs=32118) %>%
filter(POOL_STATUS =="ACTIVE")
pprSwimmingPool <- st_read('https://opendata.arcgis.com/datasets/c6f6176968f04d3f88adbc4c362af55d_0.geojson')%>%
st_transform(crs=32118) %>%
filter(POOL_STATUS =="ACTIVE")%>%
mutate(count=1) %>%
st_buffer(1000) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(exerciseNum = sum(count))
# SwimmingPool
pprSwimmingPool <- st_read('https://opendata.arcgis.com/datasets/c6f6176968f04d3f88adbc4c362af55d_0.geojson')%>%
st_transform(crs=32118) %>%
filter(POOL_STATUS =="ACTIVE")%>%
mutate(count=1) %>%
st_buffer(1000) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(swimmingPoolNum = sum(count))
attractivenssData <- attractivenssData %>%left_join(pprSwimmingPool, by="placekey")
attractivenssData$swimmingPoolNum[is.na(attractivenssData$swimmingPoolNum)] <- 0
View(pprTennisCourt)
pprTennisCourt <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tennis_courts&filename=ppr_tennis_courts&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
dplyr::select(court_number) %>%
st_buffer(1000) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(tennisCourtNum = sum(court_number))
pprTennisCourt <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tennis_courts&filename=ppr_tennis_courts&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
dplyr::select(court_number) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(tennisCourtNum = sum(court_number))
pprTennisCourt <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tennis_courts&filename=ppr_tennis_courts&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
dplyr::select(court_number)
pprTennisCourt <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tennis_courts&filename=ppr_tennis_courts&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118)
pprTennisCourt <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tennis_courts&filename=ppr_tennis_courts&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(1000) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(tennisCourtNum = sum(count))
pprTennisCourt <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tennis_courts&filename=ppr_tennis_courts&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(1000) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(tennisCourtNum = sum(count))
attractivenssData <- attractivenssData %>%left_join(pprTennisCourt, by="placekey")
attractivenssData$tennisCourtNum[is.na(attractivenssData$tennisCourtNum)] <- 0
pprSpraygrounds <- st_read('https://opendata.arcgis.com/datasets/a148cc904d374b22bd456e44a044d554_0.geojson')%>%
st_transform(crs)
View(pprSpraygrounds)
pprSpraygrounds <- st_read('https://opendata.arcgis.com/datasets/a148cc904d374b22bd456e44a044d554_0.geojson')%>%
st_transform(crs=32118) %>%
filter(SPRAY_STATUS =="ACTIVE")%>%
mutate(count=1) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(spraygroundNum = sum(count))
pprSpraygrounds <- st_read('https://opendata.arcgis.com/datasets/a148cc904d374b22bd456e44a044d554_0.geojson')%>%
st_transform(crs=32118) %>%
filter(SPRAY_STATUS =="ACTIVE")%>%
mutate(count=1) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(spraygroundNum = sum(count))
attractivenssData <- attractivenssData %>%left_join(pprSpraygrounds, by="placekey")
attractivenssData$spraygroundNum[is.na(attractivenssData$spraygroundNum)] <- 0
View(pprHydrationStations)
pprHydrationStations <- st_read('https://opendata.arcgis.com/datasets/cc35dc98180249fb9a6f2f5f06657df1_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(hydrationNum = sum(count))
#####
pprHydrationStations <- st_read('https://opendata.arcgis.com/datasets/cc35dc98180249fb9a6f2f5f06657df1_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(hydrationNum = sum(count))
pprHydrationStations <- st_read('https://opendata.arcgis.com/datasets/cc35dc98180249fb9a6f2f5f06657df1_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(hydrationNum = sum(count))
attractivenssData <- attractivenssData %>%left_join(pprHydrationStations, by="placekey")
attractivenssData$hydrationNum[is.na(attractivenssData$hydrationNum)] <- 0
source("D:/OneDrive/WORK/Upenn/Spring_MUSA_801_Practicum/MUSA_801_PPR/calculateAttractiveness.R", echo=TRUE)
View(pprPlaygrounds)
pprPlaygrounds <- st_read('https://opendata.arcgis.com/datasets/899c807e205244278b3f39421be8489c_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(playgroundNum = sum(count))
#####
pprPlaygrounds <- st_read('https://opendata.arcgis.com/datasets/899c807e205244278b3f39421be8489c_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(1000) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(playgroundNum = sum(count))
pprPlaygrounds <- st_read('https://opendata.arcgis.com/datasets/899c807e205244278b3f39421be8489c_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(1000) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(playgroundNum = sum(count))
attractivenssData <- attractivenssData %>%left_join(pprPlaygrounds, by="placekey")
attractivenssData$playgroundNum[is.na(attractivenssData$playgroundNum)] <- 0
View(pprBuildingStructures)
#####
pprBuildingStructures <- st_read('https://opendata.arcgis.com/datasets/97e90a049a35453ba0c51f974b3c77b4_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()%>%
group_by(placekey) %>%
summarise(facilityNum = sum(count),facilityArea = sum(Shape_Area))
#####
pprBuildingStructures <- st_read('https://opendata.arcgis.com/datasets/97e90a049a35453ba0c51f974b3c77b4_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()
#####
pprBuildingStructures <- st_read('https://opendata.arcgis.com/datasets/97e90a049a35453ba0c51f974b3c77b4_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na() %>%
group_by(placekey) %>%
summarise(facilityNum = sum(count),facilityArea = sum(Shape_Area))
#####
pprBuildingStructures <- st_read('https://opendata.arcgis.com/datasets/97e90a049a35453ba0c51f974b3c77b4_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na() %>%
group_by(placekey) %>%
summarise(facilityNum = sum(count))
#####
pprBuildingStructures <- st_read('https://opendata.arcgis.com/datasets/97e90a049a35453ba0c51f974b3c77b4_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na() %>%
group_by(placekey) %>%
summarise(,facilityArea = sum(Shape_Area))
#####
pprBuildingStructures <- st_read('https://opendata.arcgis.com/datasets/97e90a049a35453ba0c51f974b3c77b4_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na()
colnames(pprBuildingStructures)
group_by(placekey) %>%
summarise(facilityNum = sum(count),facilityArea = sum(Shape__Area))
#####
pprBuildingStructures <- st_read('https://opendata.arcgis.com/datasets/97e90a049a35453ba0c51f974b3c77b4_0.geojson')%>%
st_transform(crs=32118) %>%
mutate(count=1) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na() %>%
group_by(placekey) %>%
summarise(facilityNum = sum(count),facilityArea = sum(Shape__Area))
View(pprTreeCanopy)
pprTreeCanopy <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tree_canopy_points_2015&filename=ppr_tree_canopy_points_2015&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs)%>%
left_join(pprTreeCanopyWithArea,by = "objectid") %>%
st_transform(crs=32118) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na() %>%
group_by(placekey) %>%
summarise(treeHeight = mean(avg_height),treeArea = sum(Shape_Area))
pprTreeCanopy <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tree_canopy_points_2015&filename=ppr_tree_canopy_points_2015&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs)%>%
left_join(pprTreeCanopyWithArea,by = "objectid") %>%
st_transform(crs=32118) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na() %>%
group_by(placekey) %>%
summarise(treeHeight = mean(avg_height),treeArea = sum(shape_area))
View(pprTreeCanopyWithArea)
pprTreeCanopy <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tree_canopy_points_2015&filename=ppr_tree_canopy_points_2015&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs)%>%
left_join(pprTreeCanopyWithArea,by = "objectid")
pprTreeCanopy <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tree_canopy_points_2015&filename=ppr_tree_canopy_points_2015&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs)%>%
left_join(pprTreeCanopyWithArea,by = "objectid") %>%
st_transform(crs=32118) %>%
st_buffer(100) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na() %>%
group_by(placekey) %>%
summarise(treeHeight = mean(avg_height),treeArea = sum(shape_area))
pprTreeCanopy <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tree_canopy_points_2015&filename=ppr_tree_canopy_points_2015&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs)%>%
left_join(pprTreeCanopyWithArea,by = "objectid") %>%
st_transform(crs=32118) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na() %>%
group_by(placekey) %>%
summarise(treeHeight = mean(avg_height),treeArea = sum(shape_area))
pprTreeCanopy <- st_read('https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+ppr_tree_canopy_points_2015&filename=ppr_tree_canopy_points_2015&format=geojson&skipfields=cartodb_id')%>%
st_transform(crs)%>%
left_join(pprTreeCanopyWithArea,by = "objectid") %>%
st_transform(crs=32118) %>%
st_buffer(500) %>%
st_join(attracGEO %>% st_transform(crs=32118)) %>%
st_drop_geometry()%>%
drop_na() %>%
group_by(placekey) %>%
summarise(treeHeight = mean(avg_height),treeArea = sum(shape_area))
attractivenssData <- attractivenssData %>%left_join(pprTreeCanopy, by="placekey")
attractivenssData$treeHeight[is.na(attractivenssData$treeHeight)] <- 0
attractivenssData$treeArea[is.na(attractivenssData$treeArea)] <- 0
source("D:/OneDrive/WORK/Upenn/Spring_MUSA_801_Practicum/MUSA_801_PPR/calculateAttractiveness.R", echo=TRUE)
source("D:/OneDrive/WORK/Upenn/Spring_MUSA_801_Practicum/MUSA_801_PPR/calculateAttractiveness.R", echo=TRUE)
attractivenssData <-
attractivenssData %>%
mutate(totalExerciseNum = exerciseNum + swimmingPoolNum + playgroundNum) %>%
dplyr::select(-exerciseNum,-swimmingPoolNum,-playgroundNum)
source("D:/OneDrive/WORK/Upenn/Spring_MUSA_801_Practicum/MUSA_801_PPR/calculateAttractiveness.R", echo=TRUE)
